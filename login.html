<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nexus Tech | Member Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap");
      body {
        font-family: "Inter", sans-serif;
      }
      /* Custom Animation for fading elements in/out */
      .fade-in {
        animation: fadeIn 0.4s ease-in-out forwards;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Hide scrollbar for clean UI in history list */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
    </style>
  </head>
  <body
    class="bg-slate-900 text-slate-200 antialiased selection:bg-indigo-500 selection:text-white min-h-screen flex flex-col"
  >
    <div
      id="auth-view"
      class="flex-1 flex items-center justify-center p-4 relative overflow-hidden"
    >
      <div
        class="absolute top-0 left-1/2 -translate-x-1/2 w-full h-full bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-indigo-900/40 via-slate-900 to-slate-900 -z-10"
      ></div>

      <div
        class="w-full max-w-md bg-slate-800/50 backdrop-blur-xl border border-slate-700 rounded-2xl shadow-2xl p-8 fade-in"
      >
        <div class="flex flex-col items-center mb-8">
          <i class="fa-solid fa-microchip text-indigo-500 text-4xl mb-2"></i>
          <h1 class="text-2xl font-bold text-white tracking-wide">
            Nexus Tech ID
          </h1>
          <p class="text-slate-400 text-sm">
            Access the future of gaming & code
          </p>
        </div>

        <div class="flex bg-slate-900/80 rounded-lg p-1 mb-8 relative">
          <div
            id="toggle-bg"
            class="absolute left-1 top-1 w-[calc(50%-4px)] h-[calc(100%-8px)] bg-indigo-600 rounded-md transition-all duration-300"
          ></div>
          <button
            onclick="switchAuthMode('login')"
            class="flex-1 py-2 text-sm font-semibold z-10 transition-colors text-white"
            id="btn-login-toggle"
          >
            Sign In
          </button>
          <button
            onclick="switchAuthMode('register')"
            class="flex-1 py-2 text-sm font-semibold z-10 transition-colors text-slate-400"
            id="btn-register-toggle"
          >
            Register
          </button>
        </div>

        <div
          id="auth-error"
          class="hidden mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-xs text-center"
        ></div>

        <form id="login-form" class="space-y-5 block">
          <div>
            <label
              class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2"
              >Username</label
            >
            <div class="relative">
              <span class="absolute left-3 top-3 text-slate-500"
                ><i class="fa-solid fa-user"></i
              ></span>
              <input
                type="text"
                id="login-username"
                required
                class="w-full bg-slate-900 border border-slate-700 text-white rounded-lg py-2.5 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm placeholder-slate-600"
                placeholder="Enter username"
              />
            </div>
          </div>
          <div>
            <label
              class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2"
              >Password</label
            >
            <div class="relative">
              <span class="absolute left-3 top-3 text-slate-500"
                ><i class="fa-solid fa-lock"></i
              ></span>
              <input
                type="password"
                id="login-password"
                required
                class="w-full bg-slate-900 border border-slate-700 text-white rounded-lg py-2.5 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm placeholder-slate-600"
                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              />
            </div>
          </div>
          <button
            type="submit"
            class="w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg transition shadow-lg shadow-indigo-600/20"
          >
            Sign In to Nexus
          </button>
        </form>

        <form id="register-form" class="space-y-5 hidden">
          <div>
            <label
              class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2"
              >Full Name</label
            >
            <div class="relative">
              <span class="absolute left-3 top-3 text-slate-500"
                ><i class="fa-solid fa-id-card"></i
              ></span>
              <input
                type="text"
                id="reg-fullname"
                required
                class="w-full bg-slate-900 border border-slate-700 text-white rounded-lg py-2.5 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm placeholder-slate-600"
                placeholder="John Doe"
              />
            </div>
          </div>
          <div>
            <label
              class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2"
              >Username</label
            >
            <div class="relative">
              <span class="absolute left-3 top-3 text-slate-500"
                ><i class="fa-solid fa-at"></i
              ></span>
              <input
                type="text"
                id="reg-username"
                required
                class="w-full bg-slate-900 border border-slate-700 text-white rounded-lg py-2.5 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm placeholder-slate-600"
                placeholder="johndoe123"
              />
            </div>
          </div>
          <div>
            <label
              class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2"
              >Password</label
            >
            <div class="relative">
              <span class="absolute left-3 top-3 text-slate-500"
                ><i class="fa-solid fa-lock"></i
              ></span>
              <input
                type="password"
                id="reg-password"
                required
                class="w-full bg-slate-900 border border-slate-700 text-white rounded-lg py-2.5 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm placeholder-slate-600"
                placeholder="Create a password"
              />
            </div>
          </div>
          <button
            type="submit"
            class="w-full py-3 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg transition shadow-lg shadow-emerald-600/20"
          >
            Create Account
          </button>
        </form>

        <div class="mt-6 text-center">
          <a
            href="index.html"
            class="text-xs text-slate-500 hover:text-indigo-400 transition"
            >&larr; Back to Main Site</a
          >
        </div>
      </div>
    </div>

    <div id="dashboard-view" class="hidden flex-col min-h-screen bg-slate-900">
      <nav
        class="sticky top-0 z-50 w-full bg-slate-900/95 backdrop-blur-md border-b border-slate-700 shadow-lg"
      >
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="flex items-center justify-between h-16">
            <a
              href="index.html"
              class="flex items-center gap-2 hover:opacity-80 transition cursor-pointer"
            >
              <i class="fa-solid fa-microchip text-indigo-500 text-2xl"></i>
              <span class="font-bold text-xl text-white tracking-wide"
                >Nexus Tech</span
              >
            </a>

            <div class="flex items-center gap-4">
              <span
                id="nav-greeting"
                class="hidden md:block text-sm text-slate-300"
              ></span>

              <img
                id="nav-avatar"
                src=""
                alt="Profile"
                class="w-8 h-8 rounded-full border border-slate-600 object-cover"
              />

              <a
                href="index.html"
                class="text-slate-400 hover:text-indigo-400 transition ml-2"
                title="Back to Home"
              >
                <i class="fa-solid fa-house"></i>
              </a>

              <button
                onclick="handleLogout()"
                class="text-slate-400 hover:text-red-400 transition ml-2"
                title="Logout"
              >
                <i class="fa-solid fa-right-from-bracket"></i>
              </button>
            </div>
          </div>
        </div>
      </nav>

      <main class="flex-1 max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8 w-full">
        <div class="mb-10 fade-in">
          <h2 id="dash-welcome" class="text-3xl font-bold text-white mb-2">
            Welcome Back
          </h2>
          <p class="text-slate-400">Here is your reading overview for today.</p>
        </div>

        <div
          class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10 fade-in"
          style="animation-delay: 0.1s"
        >
          <div
            class="bg-slate-800 rounded-2xl p-6 border border-slate-700 flex items-center justify-between"
          >
            <div>
              <p class="text-slate-400 text-sm font-medium mb-1">
                Articles Read
              </p>
              <h3 id="stat-articles" class="text-3xl font-bold text-white">
                0
              </h3>
            </div>
            <div
              class="w-12 h-12 bg-blue-500/10 rounded-xl flex items-center justify-center text-blue-400 text-xl"
            >
              <i class="fa-solid fa-book-open"></i>
            </div>
          </div>

          <div
            class="bg-slate-800 rounded-2xl p-6 border border-slate-700 flex items-center justify-between"
          >
            <div>
              <p class="text-slate-400 text-sm font-medium mb-1">
                Login Streak
              </p>
              <div class="flex items-baseline gap-2">
                <h3 id="stat-streak" class="text-3xl font-bold text-white">
                  1
                </h3>
                <span class="text-xs text-orange-400 font-bold uppercase"
                  >Days ðŸ”¥</span
                >
              </div>
            </div>
            <div
              class="w-12 h-12 bg-orange-500/10 rounded-xl flex items-center justify-center text-orange-400 text-xl"
            >
              <i class="fa-solid fa-fire"></i>
            </div>
          </div>

          <div
            class="bg-slate-800 rounded-2xl p-6 border border-slate-700 flex items-center justify-between"
          >
            <div>
              <p class="text-slate-400 text-sm font-medium mb-1">
                Saved Guides
              </p>
              <h3 id="stat-saved" class="text-3xl font-bold text-white">0</h3>
            </div>
            <div
              class="w-12 h-12 bg-indigo-500/10 rounded-xl flex items-center justify-center text-indigo-400 text-xl"
            >
              <i class="fa-solid fa-bookmark"></i>
            </div>
          </div>
        </div>

        <div
          class="grid grid-cols-1 lg:grid-cols-3 gap-8 fade-in"
          style="animation-delay: 0.2s"
        >
          <div
            class="lg:col-span-2 bg-slate-800 rounded-2xl border border-slate-700 overflow-hidden"
          >
            <div
              class="p-6 border-b border-slate-700 flex justify-between items-center"
            >
              <h3 class="font-bold text-white">Reading History</h3>
              <button class="text-xs text-indigo-400 hover:text-indigo-300">
                View All
              </button>
            </div>
            <div class="p-6">
              <ul id="history-list" class="space-y-4"></ul>
            </div>
          </div>

          <div
            class="bg-slate-800 rounded-2xl border border-slate-700 overflow-hidden h-fit"
          >
            <div class="p-6 border-b border-slate-700">
              <h3 class="font-bold text-white">Profile Settings</h3>
            </div>
            <div class="p-6">
              <form id="settings-form" class="space-y-4">
                <div class="flex justify-center mb-4">
                  <img
                    id="settings-preview"
                    src=""
                    class="w-20 h-20 rounded-full border-2 border-indigo-500 object-cover"
                  />
                </div>

                <div>
                  <label class="text-xs text-slate-400 uppercase font-bold"
                    >Display Name</label
                  >
                  <input
                    type="text"
                    id="set-fullname"
                    class="w-full mt-1 bg-slate-900 border border-slate-700 rounded p-2 text-sm text-white focus:border-indigo-500 outline-none"
                  />
                </div>

                <div>
                  <label class="text-xs text-slate-400 uppercase font-bold"
                    >Username</label
                  >
                  <input
                    type="text"
                    id="set-username"
                    class="w-full mt-1 bg-slate-900 border border-slate-700 rounded p-2 text-sm text-slate-400 cursor-not-allowed"
                    readonly
                    title="Username cannot be changed"
                  />
                </div>

                <div>
                  <label class="text-xs text-slate-400 uppercase font-bold"
                    >Avatar URL</label
                  >
                  <input
                    type="url"
                    id="set-avatar"
                    class="w-full mt-1 bg-slate-900 border border-slate-700 rounded p-2 text-sm text-white focus:border-indigo-500 outline-none"
                    placeholder="https://..."
                  />
                </div>

                <button
                  type="submit"
                  class="w-full py-2 bg-slate-700 hover:bg-slate-600 text-white text-sm font-bold rounded transition"
                >
                  Save Changes
                </button>
              </form>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script>
      // ==========================================
      // 1. CONFIGURATION & EXPERT DATA
      // ==========================================
      const DB_KEY = "nexus_users_db";
      const SESSION_KEY = "nexus_active_session";

      // Expert History Data for Rudolf
      const expertHistory = [
        {
          title: "Advanced NBT Data Manipulation",
          category: "Code",
          date: "2 hours ago",
          icon: "fa-code",
        },
        {
          title: "System Admin: Root Access Guide",
          category: "Server",
          date: "5 hours ago",
          icon: "fa-server",
        },
        {
          title: "RTX 5090 vs RX 8900 XT Benchmarks",
          category: "Hardware",
          date: "1 day ago",
          icon: "fa-microchip",
        },
        {
          title: "React Hooks Masterclass 2025",
          category: "Code",
          date: "2 days ago",
          icon: "fa-laptop-code",
        },
        {
          title: "Optimizing Minecraft Server Ram",
          category: "Server",
          date: "3 days ago",
          icon: "fa-network-wired",
        },
      ];

      // ==========================================
      // 2. DATABASE HELPERS
      // ==========================================
      function getUsersDB() {
        const data = localStorage.getItem(DB_KEY);
        return data ? JSON.parse(data) : [];
      }

      function saveUsersDB(users) {
        localStorage.setItem(DB_KEY, JSON.stringify(users));
      }

      function getActiveSession() {
        return localStorage.getItem(SESSION_KEY);
      }

      function setActiveSession(username) {
        if (username) localStorage.setItem(SESSION_KEY, username);
        else localStorage.removeItem(SESSION_KEY);
      }

      function getUserByUsername(username) {
        return getUsersDB().find((u) => u.username === username);
      }

      function updateUser(updatedUser) {
        let users = getUsersDB();
        const index = users.findIndex(
          (u) => u.username === updatedUser.username
        );
        if (index !== -1) {
          users[index] = updatedUser;
          saveUsersDB(users);
          return true;
        }
        return false;
      }

      // ==========================================
      // 3. AUTHENTICATION LOGIC
      // ==========================================
      const authView = document.getElementById("auth-view");
      const dashboardView = document.getElementById("dashboard-view");
      const authError = document.getElementById("auth-error");

      function switchAuthMode(mode) {
        const loginForm = document.getElementById("login-form");
        const regForm = document.getElementById("register-form");
        const bg = document.getElementById("toggle-bg");
        const btnLogin = document.getElementById("btn-login-toggle");
        const btnReg = document.getElementById("btn-register-toggle");

        authError.classList.add("hidden");

        if (mode === "login") {
          loginForm.classList.remove("hidden");
          regForm.classList.add("hidden");
          bg.style.transform = "translateX(0)";
          bg.style.left = "4px";
          btnLogin.classList.replace("text-slate-400", "text-white");
          btnReg.classList.replace("text-white", "text-slate-400");
        } else {
          loginForm.classList.add("hidden");
          regForm.classList.remove("hidden");
          bg.style.left = "50%";
          btnLogin.classList.replace("text-white", "text-slate-400");
          btnReg.classList.replace("text-slate-400", "text-white");
        }
      }

      // REGISTER
      document
        .getElementById("register-form")
        .addEventListener("submit", (e) => {
          e.preventDefault();
          const fullname = document.getElementById("reg-fullname").value;
          const username = document.getElementById("reg-username").value;
          const password = document.getElementById("reg-password").value;

          const users = getUsersDB();

          if (users.some((u) => u.username === username)) {
            showError("Username already taken.");
            return;
          }

          const newUser = {
            fullname,
            username,
            password,
            avatar: `https://ui-avatars.com/api/?name=${fullname}&background=6366f1&color=fff`,
            articlesRead: 0,
            streak: 1,
            savedGuides: 0, // Default for new users
            lastLogin: new Date().toDateString(),
          };

          users.push(newUser);
          saveUsersDB(users);
          setActiveSession(username);
          checkSession();
        });

      // LOGIN
      document.getElementById("login-form").addEventListener("submit", (e) => {
        e.preventDefault();
        const username = document.getElementById("login-username").value;
        const password = document.getElementById("login-password").value;
        const user = getUserByUsername(username);

        if (user && user.password === password) {
          processLoginStreak(user);
          setActiveSession(username);
          checkSession();
        } else {
          showError("Invalid username or password.");
        }
      });

      function showError(msg) {
        authError.textContent = msg;
        authError.classList.remove("hidden");
      }

      function handleLogout() {
        setActiveSession(null);
        document.getElementById("login-form").reset();
        document.getElementById("register-form").reset();
        switchAuthMode("login");
        checkSession();
      }

      // ==========================================
      // 4. DASHBOARD LOGIC
      // ==========================================
      function checkSession() {
        const currentUser = getActiveSession();
        if (currentUser) {
          authView.classList.add("hidden");
          authView.classList.remove("flex");
          dashboardView.classList.remove("hidden");
          dashboardView.classList.add("flex");
          renderDashboard(currentUser);
        } else {
          authView.classList.remove("hidden");
          authView.classList.add("flex");
          dashboardView.classList.add("hidden");
          dashboardView.classList.remove("flex");
        }
      }

      function processLoginStreak(user) {
        const today = new Date().toDateString();
        if (user.lastLogin === today) return;

        const yesterday = new Date();
        yesterday.setDate(yesterday.getDate() - 1);

        if (user.lastLogin === yesterday.toDateString()) {
          user.streak += 1;
        } else {
          if (user.username !== "Rudolf") user.streak = 1; // Rudolf never loses streak
        }
        user.lastLogin = today;
        updateUser(user);
      }

      function renderDashboard(username) {
        const user = getUserByUsername(username);
        if (!user) {
          handleLogout();
          return;
        }

        // --- FILL STATS ---
        document.getElementById(
          "nav-greeting"
        ).textContent = `Welcome, ${user.username}`;
        document.getElementById("nav-avatar").src = user.avatar;
        document.getElementById(
          "dash-welcome"
        ).textContent = `Welcome back, ${user.fullname}`;

        document.getElementById("stat-articles").textContent =
          user.articlesRead;
        document.getElementById("stat-streak").textContent = user.streak;
        // This targets the ID you added in Step 1
        document.getElementById("stat-saved").textContent =
          user.savedGuides || 0;

        // --- HISTORY LIST ---
        const listContainer = document.getElementById("history-list");
        listContainer.innerHTML = "";

        const historyData = username === "Rudolf" ? expertHistory : [];

        if (historyData.length === 0) {
          listContainer.innerHTML = `<li class="text-slate-500 text-sm text-center py-4">No reading history yet.</li>`;
        } else {
          historyData.forEach((item) => {
            const li = document.createElement("li");
            li.className =
              "flex items-center gap-4 p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 hover:border-indigo-500/30 transition";
            li.innerHTML = `
                    <div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-slate-400">
                        <i class="fa-solid ${item.icon}"></i>
                    </div>
                    <div>
                        <h4 class="text-sm font-semibold text-white">${item.title}</h4>
                        <span class="text-xs text-slate-500">${item.category} â€¢ ${item.date}</span>
                    </div>`;
            listContainer.appendChild(li);
          });
        }

        // --- SETTINGS FORM ---
        document.getElementById("set-fullname").value = user.fullname;
        document.getElementById("set-username").value = user.username;
        document.getElementById("set-avatar").value = user.avatar;
        document.getElementById("settings-preview").src = user.avatar;
      }

      // UPDATE PROFILE
      document
        .getElementById("settings-form")
        .addEventListener("submit", (e) => {
          e.preventDefault();
          const username = getActiveSession();
          const user = getUserByUsername(username);
          user.fullname = document.getElementById("set-fullname").value;
          user.avatar = document.getElementById("set-avatar").value;
          updateUser(user);
          renderDashboard(username);
          alert("Profile updated successfully!");
        });

      // ==========================================
      // 5. INITIALIZATION & RUDOLF FORCE RESET
      // ==========================================
      window.addEventListener("DOMContentLoaded", () => {
        const users = getUsersDB();

        // --- FORCE UPDATE RUDOLF ---
        // We delete old Rudolf so we can give him new stats every reload
        const rudolfIndex = users.findIndex((u) => u.username === "Rudolf");
        if (rudolfIndex !== -1) {
          users.splice(rudolfIndex, 1);
        }

        // Create Fresh Rudolf with EXPERT STATS
        const adminUser = {
          fullname: "Rudolf",
          username: "Rudolf",
          password: "12345678",
          avatar:
            "https://ui-avatars.com/api/?name=Rudolf&background=000000&color=fff",
          articlesRead: 1240, // <--- Articles Count
          streak: 365, // <--- Streak Count
          savedGuides: 85, // <--- Saved Guides Count
          lastLogin: new Date().toDateString(),
        };

        users.push(adminUser);
        saveUsersDB(users);
        checkSession();
      });
    </script>
  </body>
</html>
